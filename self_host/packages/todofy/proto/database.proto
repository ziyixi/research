syntax = "proto3";

package self_host.packages.todofy;

import "google/protobuf/timestamp.proto";
import "self_host/packages/todofy/proto/large_language_model.proto";

option go_package = "self_host/packages/todofy/proto";

enum DatabaseType {
  DATABASE_TYPE_UNSPECIFIED = 0;
  // SQLite database
  DATABASE_TYPE_SQLITE = 1;
}

message DataBaseSchema {
  // the timestamp of the creation.
  google.protobuf.Timestamp created_at = 1;
  // the timestamp of the last update.
  google.protobuf.Timestamp updated_at = 2;
  // the model family
  ModelFamily model_family = 3;
  // the model to use for the request.
  Model model = 4;
  // The prompt to summarize.
  string prompt = 5;
  // The maximum number of tokens to generate.
  int32 max_tokens = 6;
  // The text to summarize.
  string text = 7;
  // The summary of the text.
  string summary = 8;
}

message WriteRequest {
  // The type of database to use.
  DatabaseType type = 1;
  // The name of the database.
  string name = 2;
  // The schema of the database.
  DataBaseSchema schema = 3;
}

message QueryRecentRequest {
  // The type of database to use.
  DatabaseType type = 1;
  // The name of the database.
  string name = 2;
  // start timestamp of the query.
  google.protobuf.Timestamp start = 3;
  // end timestamp of the query.
  google.protobuf.Timestamp end = 4;
}

message QueryRecentResponse {
  // Recent entries in the database.
  repeated DataBaseSchema entries = 1;
}

message WriteResponse {
  // An empty message.
}

service DataBaseService {
  // Write to the database.
  rpc Write(WriteRequest) returns (WriteResponse);
  // Query recent entries in the database.
  rpc QueryRecent(QueryRecentRequest) returns (QueryRecentResponse);
}